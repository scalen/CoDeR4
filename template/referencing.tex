\makeatletter

\def\@multiref[#1]#2{%
	\@listfirstref[#1]#2,\relax%
}
\def\@listfirstref[#1]#2,#3\relax{%
      \ifx\relax#3\relax  %
         \def\next{~\@prefref[#1]{#2}}%
      \else
         \def\next{s~\@prefref[#1]{#2}\@listrefs[#1]#3\relax}%
      \fi%
      \next%
}
\def\@listrefs[#1]#2,#3\relax{%
      \ifx\relax#3\relax  %
         \def\next{\@endmultiref[#1]{#2}}%
      \else
         \def\next{\@listref[#1]{#2}\@listrefs[#1]#3\relax}%
      \fi%
      \next%
}
\def\@listref[#1]#2{, \@prefref[#1]{#2}}
\def\@endmultiref[#1]#2{ and~\@prefref[#1]{#2}}
\def\@prefref[#1]#2{%
	\ifx\relax#1\relax%
      \def\next{\ref{#2}}%
   \else%
      \def\next{\ref{#1:#2}}%
   \fi%
   \next%
}

% \let\@label\label
% \renewcommand{\label}[1]{ %
%    \ifx \@figenv \@currenvir
%       \@label{fig:#1}
%    \else
%       \ifx \@tabenv \@currenvir
%          \@label{tab:#1}
%       \else

%       \fi
%    \fi
% }

% \def\@iffig{figure}
% \def\@tabenv{table}
% \def\@eqnenv{equation}
% \def\@algenv{algorithm}

\def\labelfig#1{\label{fig:#1}}
\def\reffig#1{Figure\@multiref[fig]{#1}}
\def\labeltab#1{\label{tab:#1}}
\def\reftab#1{Table\@multiref[tab]{#1}}
\def\refsec#1{Section\@multiref[sec]{#1}}
\def\refchap#1{Chapter\@multiref[sec]{#1}}
\def\refapp#1{Appendix~\@prefref[app]{#1}}
\def\labeleqn#1{\label{eqn:#1}}
\def\refeqn#1{Equation\@multiref[eqn]{#1}}
\def\labelalg#1{\label{alg:#1}}
\def\refalg#1{Algorithm\@multiref[alg]{#1}}
\def\labelhyp#1{\label{hyp:#1}}
\def\refhyp#1{Hypothesis~\@prefref[hyp]{#1}}
\def\labelqstn#1{\label{qstn:#1}}
\def\refqstn#1{Question\@multiref[qstn]{#1}}
\def\labeldef#1{\label{def:#1}}
\def\refdef#1{Definition\@multiref[def]{#1}}
\def\labelcha#1{\label{cha:#1}}
\def\refcha#1{challenge of \@prefref[cha]{#1}}

\makeatother